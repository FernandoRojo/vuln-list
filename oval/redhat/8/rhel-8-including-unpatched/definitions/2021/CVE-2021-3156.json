{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20213156",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2021-3156 sudo: Heap buffer overflow in argument parsing (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2021-3156",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2021-3156"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in sudo. A heap-based buffer overflow was found in the way sudo parses command line arguments. This flaw is exploitable by any local user (normal users and system users, sudoers and non-sudoers), without authentication (i.e., the attacker does not need to know the user's password). Successful exploitation of this flaw could lead to privilege escalation. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.\n            \n            MITIGATION: Red Hat Product Security strongly recommends customers to update to fixed sudo packages once they are available. For customers who cannot update immediately, the following interim partial mitigation using systemtap is suggested:\n\n1. Install required systemtap packages and dependencies: \nsystemtap yum-utils kernel-devel-\"$(uname -r)\"\n\nThen for RHEL 7 install kernel debuginfo, using: debuginfo-install -y kernel-\"$(uname -r)\" \nThen for RHEL 8 install sudo debuginfo, using: debuginfo-install sudo\n \n2. Create the following systemtap script: (call the file as sudoedit-block.stap)\n\nprobe process(\"/usr/bin/sudo\").function(\"main\")  {\n        command = cmdline_args(0,0,\"\");\n        if (strpos(command, \"edit\") \u003e= 0) {\n                raise(9);\n        }\n}\n\n3. Install the script using the following command: (using root)\n# nohup stap -g sudoedit-block.stap \u0026\n(This should output the PID number of the systemtap script)\n\nThis script will cause the vulnerable sudoedit binary to stop working. The sudo command will still work as usual.\nThe above change does not persist across reboots and must be applied after each reboot.\n\n4. Once the new fixed packages are installed, the systemtap script can be removed by killing the systemtap process.  For example, by using:\n# kill -s SIGTERM 7590 (where 7590 is the PID of the systemtap process)",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20137488004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20137488003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "sudo is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201919234003"
                  },
                  {
                    "Comment": "sudo is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201919234004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "sudo-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201919234001"
                  },
                  {
                    "Comment": "sudo-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201919234002"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}